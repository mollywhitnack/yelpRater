"use strict";var app=angular.module("myApp",["ui.router","satellizer","ngFileUpload"]);app.config(["$authProvider",function(e){e.loginUrl="api/users/login",e.signupUrl="api/users/signup",e.facebook({clientId:"255060128209165",url:"/api/users/facebook"})}]),app.config(["$stateProvider","$urlRouterProvider",function(e,o){e.state("home",{url:"/",templateUrl:"/html/home.html"}).state("login",{url:"/login",templateUrl:"/html/login.html",controller:"loginCtrl"}).state("register",{url:"/register",templateUrl:"/html/register.html",controller:"registerCtrl"}).state("profile",{url:"/profile/:userId",templateUrl:"/html/profile.html",controller:"profileCtrl",resolve:{Profile:["User",function(e){return e.profile()}],ProfileByID:["User","$stateParams",function(e,o){return e.getProfile(o.userId)}]}}).state("users",{url:"/users",templateUrl:"/html/users.html",controller:"usersCtrl"}).state("business",{url:"/business",templateUrl:"/html/business.html",controller:"businessCtrl",resolve:{Profile:["User",function(e){return e.profile()}]}}).state("showBusiness",{url:"/business/:businessId",templateUrl:"html/showbusiness.html",controller:"showbusinessCtrl"}),o.otherwise("/")}]);var app=angular.module("myApp");app.controller("businessCtrl",["$scope","User","$rootScope","Business","Profile",function(e,o,s,n,t){console.log("businessCtrl"),e.businesses=[],console.log("Profile:",t);var r=t.favorites;e.searchBusiness=function(){console.log("$scope.newItem.searchParams",e.newItem.searchParams),n.searchYelp(e.newItem.searchParams).then(function(o){console.log("res from search businsess:",o);for(var s=0;s<r.length;s++)console.log(o.id," vs ",r[s]),o.id===r[s]&&(e.toggleFave=!0);e.businesses.push(o)})["catch"](function(e){console.log("err in businessCtrl: ",e)})},e.searchBusiness2=function(){console.log("search");var o={};e.newItem.location&&(o.location=e.newItem.location),e.newItem.term&&(o.term=e.newItem.term),console.log("searchBy:",o),n.searchCatagories(o).then(function(o){console.log("res from search businsess:",o);for(var s=0;s<r.length;s++)console.log(o.id," vs ",r[s]),o.id===r[s]&&(e.toggleFave=!0);e.businesses.push(o)})["catch"](function(e){console.log("err in businessCtrl: ",e)})},e.favorite=function(s){e.toggleFave=!e.toggleFave,console.log("$scope.businesses[index].id",e.businesses[s].id),o.addFavoriteToUser(t._id,e.businesses[s].id).then(n.addFavorite(e.businesses[s],t._id)).then(function(e){console.log("res:",e)})["catch"](function(e){console.log("err in businessCtrl: ",e)}),console.log("$scope.businesses[index]:",e.businesses[s].id)},e.unFavorite=function(s){e.toggleFave=!e.toggleFave,console.log("$scope.businesses[index].id",e.businesses[s].id),o.removeFavoritefromUser(t._id,e.businesses[s].id).then(function(e){console.log("res:",e)})["catch"](function(e){console.log("err in businessCtrl: ",e)}),console.log("$scope.businesses[index]:",e.businesses[s].id)}}]);var app=angular.module("myApp");app.controller("imageCtrl",["$scope","Upload","Profile","$rootScope",function(e,o,s,n){console.log("image ctrl"),n.currentUser=s,e.submit=function(){console.log("submit"),console.log("$scope.file:",e.file),o.upload({url:"/api/images",data:{photo:e.file,user:n.currentUser._id}}).then(function(o){console.log("res: ",o),e.savedImage=o.data})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("loginCtrl",["$scope","$state","$auth","$rootScope",function(e,o,s,n){console.log("loginCtrl!"),e.login=function(){s.login(e.user).then(function(e){console.log("res: ",e),o.go("profile")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("mainCtrl",["$scope","$state","$auth","$rootScope",function(e,o,s,n){console.log("mainCtrl!"),n.currentUser,e.isAuthenticated=function(){return s.isAuthenticated()},e.logout=function(){s.logout(),o.go("home")},e.authenticate=function(e){s.authenticate(e).then(function(e){o.go("home")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("profileCtrl",["$scope","Profile","ProfileByID","$state","User","$rootScope","WallPost",function(e,o,s,n,t,r,l){console.log("profileCtrl!"),r.currentUser=o,e.user=s||o,l.getWallPosts(e.user._id).then(function(o){e.userWallposts=o}),console.log("user:",e.user),console.log("curruser:",r.currentUser),e.showdisplayNameForm=function(){console.log("show form"),e.displayNameForm=!0},e.updatedisplayName=function(){e.displayNameForm=!1,e.user.displayName=e.newItem.displayName,t.updateProfile(e.user._id,e.newItem).then(function(o){console.log("profile:",o),e.newItem.displayName=""})["catch"](function(e){console.log("err:",e)})},e.canceldisplayName=function(){e.usernameForm=!0,e.newItem.displayName=""},e.showPictureForm=function(){console.log("show form"),e.photoForm=!0},e.updatePicture=function(){e.photoForm=!1,console.log("$state.current: ",n.current),e.user.profileImage=e.newItem.profileImage,console.log("$scope.newItem:",e.newItem),t.updateProfile(e.user._id,e.newItem).then(function(o){console.log("profile:",o),e.newItem.profileImage=""})["catch"](function(e){console.log("err:",e)})},e.cancelPhotoUrl=function(){e.photoForm=!0,e.newItem.photoUrl=""},e.deleteAccount=function(e){console.log(e._id),t.deleteAccount(e._id).then()["catch"](function(e){console.log("err: ",e)})},e.submitMessage=function(){var o={to:e.user,from:r.currentUser._id,fromName:r.currentUser.displayName,text:e.newItem.text,createdAt:"add moment"};console.log("post obj:",o),l.addWallPost(o).then(function(e){console.log("wallpost:",e),t.addWallPostToUser(s._id,e._id)}).then(n.go(n.$current,null,{reload:!0}))["catch"](function(e){console.log("err: ",e)})}}]);var app=angular.module("myApp");app.controller("registerCtrl",["$scope","$state","$auth",function(e,o,s){console.log("registerCtrl!"),e.register=function(){e.user.password!==e.user.password2?(e.user.password=null,e.user.password2=null,alert("Passwords must match!")):s.signup(e.user).then(function(e){console.log("res: ",e),o.go("login")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("showbusinessCtrl",["$scope","$stateParams","Business",function(e,o,s){console.log("showbusinessCtrl!");var n=o;console.log("businessId",n.businessId),s.searchYelp(n.businessId).then(function(o){console.log("res:",o),e.business=o})["catch"](function(e){console.log("err in businessCtrl: ",e)})}]);var app=angular.module("myApp");app.controller("usersCtrl",["$scope","$$state","$state","User",function(e,o,s,n){console.log("usersCtrl!");var t=n.getAll();console.log("userPromise:",t),t.then(function(o){console.log(o.data),e.userFeed=o.data})}]);var app=angular.module("myApp");app.service("Business",["$http","$q",function(e,o){this.searchYelp=function(s){return console.log("search: ",s),e.get("/api/businesses/yelp/"+s).then(function(e){return console.log("res.data in services:",e.data),console.log("res in services:",e),o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.searchCatagories=function(s){return console.log("inputs",s),e.get("/api/businesses/yelpCatagories",s).then(function(e){return console.log("res.data in services:",e.data),console.log("res in services:",e),o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.addFavorite=function(s,n){return console.log("businessObj:",s),e.post("/api/businesses/"+n,s).then(function(e){return console.log("res ln 24 business services:",e),o.resolve(e)})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.service("image",["$http","$q",function(e,o){this.getAll=function(){return e.get("/api/cruds")},this.getById=function(o){return e.get("/api/cruds/"+o)},this.addCrud=function(s){return e.post("/api/cruds",s).then(function(e){return o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.deleteCrud=function(s){return e["delete"]("/api/cruds/"+s).then(function(){return o.resolve()})["catch"](function(e){console.log("err:",e)})},this.updateCrud=function(s,n){return e.put("/api/cruds/"+s,n).then(function(e){return o.resolve(n)})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.service("User",["$http","$q",function(e,o){this.profile=function(){return e.get("/api/users/profile").then(function(e){return o.resolve(e.data)})},this.getProfile=function(s){return e.get("/api/users/profile/"+s).then(function(e){return o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.getAll=function(){return e.get("/api/users")},this.updateProfile=function(s,n){return console.log("here"),console.log(s," ",n),e.put("/api/users/profile/"+s,n).then(function(e){return o.resolve()})["catch"](function(e){console.log("err:",e)})},this.deleteAccount=function(s){return e["delete"]("/api/users/profile/"+s).then(function(e){return o.resolve()})["catch"](function(e){console.log("err:",e)})},this.addFavoriteToUser=function(s,n){return e.put("/api/users/profile/"+s+"/add/"+n).then(function(e){return o.resolve()})["catch"](function(e){console.log("err:",e)})},this.removeFavoritefromUser=function(s,n){return console.log("remove Favorite","id:",s,"yelpId",n),e.put("/api/users/profile/"+s+"/remove/"+n).then(function(e){return console.log("res ln 53:",e),o.resolve()})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.service("WallPost",["$http","$q",function(e,o){this.addWallPost=function(s){return console.log("in add wallpost: ",s),e.post("/api/wallposts",s).then(function(e){return o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.getWallPosts=function(s){return e.get("/api/wallposts/"+s).then(function(e){return o.resolve(e.data)})["catch"](function(e){console.log("err: ",e)})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImNvbnRyb2xsZXJzL2J1c2luZXNzQ3RybC5qcyIsImNvbnRyb2xsZXJzL2ltYWdlQ3RybC5qcyIsImNvbnRyb2xsZXJzL2xvZ2luQ3RybC5qcyIsImNvbnRyb2xsZXJzL21haW5DdHJsLmpzIiwiY29udHJvbGxlcnMvcHJvZmlsZUN0cmwuanMiLCJjb250cm9sbGVycy9yZWdpc3RlckN0cmwuanMiLCJjb250cm9sbGVycy9zaG93YnVzaW5lc3NDdHJsLmpzIiwiY29udHJvbGxlcnMvdXNlcnNDdHJsLmpzIiwic2VydmljZXMvYnVzaW5lc3NzZXJ2aWNlcy5qcyIsInNlcnZpY2VzL2ltYWdlc2VydmljZXMuanMiLCJzZXJ2aWNlcy91c2Vyc2VydmljZXMuanMiLCJzZXJ2aWNlcy93YWxscG9zdHNlcnZpY2VzLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkYXV0aFByb3ZpZGVyIiwibG9naW5VcmwiLCJzaWdudXBVcmwiLCJmYWNlYm9vayIsImNsaWVudElkIiwidXJsIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJzdGF0ZSIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsInJlc29sdmUiLCJQcm9maWxlIiwiVXNlciIsInByb2ZpbGUiLCJQcm9maWxlQnlJRCIsIiRzdGF0ZVBhcmFtcyIsImdldFByb2ZpbGUiLCJ1c2VySWQiLCJvdGhlcndpc2UiLCIkc2NvcGUiLCIkcm9vdFNjb3BlIiwiQnVzaW5lc3MiLCJjb25zb2xlIiwibG9nIiwiYnVzaW5lc3NlcyIsImZhdm9yaXRlcyIsInNlYXJjaEJ1c2luZXNzIiwibmV3SXRlbSIsInNlYXJjaFBhcmFtcyIsInNlYXJjaFllbHAiLCJ0aGVuIiwicmVzIiwiaSIsImxlbmd0aCIsImlkIiwidG9nZ2xlRmF2ZSIsInB1c2giLCJlcnIiLCJzZWFyY2hCdXNpbmVzczIiLCJzZWFyY2hCeSIsImxvY2F0aW9uIiwidGVybSIsInNlYXJjaENhdGFnb3JpZXMiLCJmYXZvcml0ZSIsImluZGV4IiwiYWRkRmF2b3JpdGVUb1VzZXIiLCJfaWQiLCJhZGRGYXZvcml0ZSIsInVuRmF2b3JpdGUiLCJyZW1vdmVGYXZvcml0ZWZyb21Vc2VyIiwiVXBsb2FkIiwiY3VycmVudFVzZXIiLCJzdWJtaXQiLCJmaWxlIiwidXBsb2FkIiwiZGF0YSIsInBob3RvIiwidXNlciIsInNhdmVkSW1hZ2UiLCIkc3RhdGUiLCIkYXV0aCIsImxvZ2luIiwiZ28iLCJpc0F1dGhlbnRpY2F0ZWQiLCJsb2dvdXQiLCJhdXRoZW50aWNhdGUiLCJwcm92aWRlciIsIldhbGxQb3N0IiwiZ2V0V2FsbFBvc3RzIiwidXNlcldhbGxwb3N0cyIsInNob3dkaXNwbGF5TmFtZUZvcm0iLCJkaXNwbGF5TmFtZUZvcm0iLCJ1cGRhdGVkaXNwbGF5TmFtZSIsImRpc3BsYXlOYW1lIiwidXBkYXRlUHJvZmlsZSIsImNhbmNlbGRpc3BsYXlOYW1lIiwidXNlcm5hbWVGb3JtIiwic2hvd1BpY3R1cmVGb3JtIiwicGhvdG9Gb3JtIiwidXBkYXRlUGljdHVyZSIsImN1cnJlbnQiLCJwcm9maWxlSW1hZ2UiLCJjYW5jZWxQaG90b1VybCIsInBob3RvVXJsIiwiZGVsZXRlQWNjb3VudCIsInN1Ym1pdE1lc3NhZ2UiLCJwb3N0T2JqIiwidG8iLCJmcm9tIiwiZnJvbU5hbWUiLCJ0ZXh0IiwiY3JlYXRlZEF0IiwiYWRkV2FsbFBvc3QiLCJ3YWxscG9zdCIsImFkZFdhbGxQb3N0VG9Vc2VyIiwiJGN1cnJlbnQiLCJyZWxvYWQiLCJyZWdpc3RlciIsInBhc3N3b3JkIiwicGFzc3dvcmQyIiwiYWxlcnQiLCJzaWdudXAiLCJidXNpbmVzc0lkIiwiYnVzaW5lc3MiLCIkJHN0YXRlIiwidXNlclByb21pc2UiLCJnZXRBbGwiLCJyZXN1bHQiLCJ1c2VyRmVlZCIsInNlcnZpY2UiLCIkaHR0cCIsIiRxIiwidGhpcyIsInNlYXJjaCIsImdldCIsImlucHV0cyIsImJ1c2luZXNzT2JqIiwicG9zdCIsImdldEJ5SWQiLCJhZGRDcnVkIiwiY3J1ZCIsImRlbGV0ZUNydWQiLCJ1cGRhdGVDcnVkIiwicHV0IiwicHJvZmlsZU9iaiIsInllbHBJZCJdLCJtYXBwaW5ncyI6IkFBQUEsWUFFQSxJQUFJQSxLQUFNQyxRQUFRQyxPQUFPLFNBQVUsWUFBYSxhQUFjLGdCQUU5REYsS0FBSUcsUUFBQSxnQkFBTyxTQUFTQyxHQUVsQkEsRUFBY0MsU0FBVyxrQkFDekJELEVBQWNFLFVBQVksbUJBRTFCRixFQUFjRyxVQUNaQyxTQUFVLGtCQUNWQyxJQUFLLDJCQUtUVCxJQUFJRyxRQUFBLGlCQUFBLHFCQUFPLFNBQVNPLEVBQWdCQyxHQUVsQ0QsRUFDR0UsTUFBTSxRQUFVSCxJQUFLLElBQUtJLFlBQWEsb0JBQ3ZDRCxNQUFNLFNBQ0xILElBQUssU0FDTEksWUFBYSxtQkFDYkMsV0FBWSxjQUViRixNQUFNLFlBQ0xILElBQUssWUFDTEksWUFBYSxzQkFDYkMsV0FBWSxpQkFFYkYsTUFBTSxXQUNMSCxJQUFLLG1CQUNMSSxZQUFhLHFCQUNiQyxXQUFZLGNBQ1pDLFNBQ0VDLFNBQUEsT0FBUyxTQUFTQyxHQUNoQixNQUFPQSxHQUFLQyxZQUVkQyxhQUFBLE9BQUEsZUFBYSxTQUFTRixFQUFNRyxHQUMxQixNQUFPSCxHQUFLSSxXQUFXRCxFQUFhRSxhQUl6Q1YsTUFBTSxTQUNMSCxJQUFLLFNBQ0xJLFlBQWEsbUJBQ2JDLFdBQVksY0FFYkYsTUFBTSxZQUNMSCxJQUFLLFlBQ0xJLFlBQWEsc0JBQ2JDLFdBQVksZUFDWkMsU0FDRUMsU0FBQSxPQUFTLFNBQVNDLEdBQ2hCLE1BQU9BLEdBQUtDLGVBSWpCTixNQUFNLGdCQUNMSCxJQUFLLHdCQUNMSSxZQUFhLHlCQUNiQyxXQUFZLHFCQUdoQkgsRUFBbUJZLFVBQVUsT0M5RC9CLElBQUl2QixLQUFNQyxRQUFRQyxPQUFPLFFBRXpCRixLQUFJYyxXQUFXLGdCQUFBLFNBQUEsT0FBQSxhQUFBLFdBQUEsVUFBZ0IsU0FBU1UsRUFBUVAsRUFBTVEsRUFBWUMsRUFBVVYsR0FDMUVX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LEVBQWhDLFFBQTBDMkYsR0FDL0MvRixLQUFLLFNBQUFDLEdBRUgsTUFBT2dGLEdBQUdyRyxZQUhQb0csU0FLQSxTQUFBekUsR0FDTGYsUUFBUUMsSUFBSSxPQUFRYyxNQUl4QjJFLEtBQUsvRCx1QkFBeUIsU0FBQ2YsRUFBSTJGLEdBRWpDLE1BREF2RyxTQUFRQyxJQUFJLGtCQUFtQixNQUFPVyxFQUFJLFNBQVUyRixHQUM3Q2YsRUFBTWEsSUFBTixzQkFBZ0N6RixFQUFoQyxXQUE2QzJGLEdBQ2xEL0YsS0FBSyxTQUFBQyxHQUVILE1BREFULFNBQVFDLElBQUksYUFBY1EsR0FDbkJnRixFQUFHckcsWUFIUG9HLFNBS0EsU0FBQXpFLEdBQ0xmLFFBQVFDLElBQUksT0FBUWMsUUNuRTFCLElBQUkxQyxLQUFNQyxRQUFRQyxPQUFPLFFBRXpCRixLQUFJa0gsUUFBUSxZQUFBLFFBQUEsS0FBWSxTQUFTQyxFQUFPQyxHQUVwQ0MsS0FBS3BCLFlBQWEsU0FBQ0MsR0FFbkIsTUFEQXZFLFNBQVFDLElBQUksb0JBQXFCc0UsR0FDMUJpQixFQUFNTyxLQUFOLGlCQUE2QnhCLEdBQ2pDL0QsS0FBSyxTQUFBQyxHQUNKLE1BQU9nRixHQUFHckcsUUFBUXFCLEVBQUl3QixRQUZuQnVELFNBSUUsU0FBQXpFLEdBQ0xmLFFBQVFDLElBQUksT0FBUWMsTUFLeEIyRSxLQUFLNUMsYUFBZSxTQUFDbkQsR0FDckIsTUFBTzZGLEdBQU1JLElBQU4sa0JBQTRCakcsR0FDaENhLEtBQUssU0FBQUMsR0FDSixNQUFPZ0YsR0FBR3JHLFFBQVFxQixFQUFJd0IsUUFGbkJ1RCxTQUlFLFNBQUF6RSxHQUNMZixRQUFRQyxJQUFJLFFBQVNjIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcsIFsndWkucm91dGVyJywgJ3NhdGVsbGl6ZXInLCAnbmdGaWxlVXBsb2FkJ10pO1xuXG5hcHAuY29uZmlnKGZ1bmN0aW9uKCRhdXRoUHJvdmlkZXIpIHtcblxuICAkYXV0aFByb3ZpZGVyLmxvZ2luVXJsID0gJ2FwaS91c2Vycy9sb2dpbic7XG4gICRhdXRoUHJvdmlkZXIuc2lnbnVwVXJsID0gJ2FwaS91c2Vycy9zaWdudXAnO1xuXG4gICRhdXRoUHJvdmlkZXIuZmFjZWJvb2soe1xuICAgIGNsaWVudElkOiAnMjU1MDYwMTI4MjA5MTY1JyxcbiAgICB1cmw6ICcvYXBpL3VzZXJzL2ZhY2Vib29rJ1xuICB9KTtcblxufSk7XG5cbmFwcC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuXG4gICRzdGF0ZVByb3ZpZGVyXG4gICAgLnN0YXRlKCdob21lJywgeyB1cmw6ICcvJywgdGVtcGxhdGVVcmw6ICcvaHRtbC9ob21lLmh0bWwnIH0pXG4gICAgLnN0YXRlKCdsb2dpbicsIHtcbiAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2xvZ2luLmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ2xvZ2luQ3RybCdcbiAgICB9KVxuICAgIC5zdGF0ZSgncmVnaXN0ZXInLCB7XG4gICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9yZWdpc3Rlci5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdyZWdpc3RlckN0cmwnXG4gICAgfSlcbiAgICAuc3RhdGUoJ3Byb2ZpbGUnLCB7XG4gICAgICB1cmw6ICcvcHJvZmlsZS86dXNlcklkJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvZmlsZS5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdwcm9maWxlQ3RybCcsXG4gICAgICByZXNvbHZlOiB7XG4gICAgICAgIFByb2ZpbGU6IGZ1bmN0aW9uKFVzZXIpIHtcbiAgICAgICAgICByZXR1cm4gVXNlci5wcm9maWxlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIFByb2ZpbGVCeUlEOiBmdW5jdGlvbihVc2VyLCAkc3RhdGVQYXJhbXMpe1xuICAgICAgICAgIHJldHVybiBVc2VyLmdldFByb2ZpbGUoJHN0YXRlUGFyYW1zLnVzZXJJZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuICAgIC5zdGF0ZSgndXNlcnMnLCB7XG4gICAgICB1cmw6ICcvdXNlcnMnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC91c2Vycy5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICd1c2Vyc0N0cmwnXG4gICAgfSlcbiAgICAuc3RhdGUoJ2J1c2luZXNzJywge1xuICAgICAgdXJsOiAnL2J1c2luZXNzJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvYnVzaW5lc3MuaHRtbCcsXG4gICAgICBjb250cm9sbGVyOiAnYnVzaW5lc3NDdHJsJyxcbiAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgUHJvZmlsZTogZnVuY3Rpb24oVXNlcikge1xuICAgICAgICAgIHJldHVybiBVc2VyLnByb2ZpbGUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gICAgLnN0YXRlKCdzaG93QnVzaW5lc3MnLCB7XG4gICAgICB1cmw6ICcvYnVzaW5lc3MvOmJ1c2luZXNzSWQnLCBcbiAgICAgIHRlbXBsYXRlVXJsOiAnaHRtbC9zaG93YnVzaW5lc3MuaHRtbCcsIFxuICAgICAgY29udHJvbGxlcjogJ3Nob3didXNpbmVzc0N0cmwnXG4gICAgICB9KVxuICAgIFxuICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG59KTtcblxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5sZXQgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5jb250cm9sbGVyKCdidXNpbmVzc0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFVzZXIsICRyb290U2NvcGUsIEJ1c2luZXNzLCBQcm9maWxlKXtcbiAgY29uc29sZS5sb2coXCJidXNpbmVzc0N0cmxcIik7XG5cbiAgJHNjb3BlLmJ1c2luZXNzZXMgPSBbXTtcbiAgY29uc29sZS5sb2coXCJQcm9maWxlOlwiLCBQcm9maWxlKVxuICB2YXIgZmF2b3JpdGVzID0gUHJvZmlsZS5mYXZvcml0ZXM7XG5cbiAgJHNjb3BlLnNlYXJjaEJ1c2luZXNzID0gKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCIkc2NvcGUubmV3SXRlbS5zZWFyY2hQYXJhbXNcIiAsICRzY29wZS5uZXdJdGVtLnNlYXJjaFBhcmFtcylcbiAgICAgIEJ1c2luZXNzLnNlYXJjaFllbHAoJHNjb3BlLm5ld0l0ZW0uc2VhcmNoUGFyYW1zKVxuICAgICAgLnRoZW4ocmVzID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcInJlcyBmcm9tIHNlYXJjaCBidXNpbnNlc3M6XCIgLCByZXMpO1xuICAgICAgICBmb3IodmFyIGk9MDsgaTwgZmF2b3JpdGVzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuaWQgLFwiIHZzIFwiLCBmYXZvcml0ZXNbaV0pO1xuICAgICAgICAgIGlmKHJlcy5pZCA9PT0gZmF2b3JpdGVzW2ldKXtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGVGYXZlID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLmJ1c2luZXNzZXMucHVzaChyZXMpO1xuICAgICAgfSkgICAgXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVyciBpbiBidXNpbmVzc0N0cmw6IFwiLCBlcnIpO1xuICAgICAgfSlcbiAgICB9XG5cbiAgJHNjb3BlLnNlYXJjaEJ1c2luZXNzMiA9ICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwic2VhcmNoXCIpO1xuICAgICAgdmFyIHNlYXJjaEJ5ID0ge307XG5cbiAgICAgIGlmKCRzY29wZS5uZXdJdGVtLmxvY2F0aW9uKXtcbiAgICAgICAgc2VhcmNoQnkubG9jYXRpb24gPSAkc2NvcGUubmV3SXRlbS5sb2NhdGlvblxuICAgICAgfVxuICAgICAgaWYoJHNjb3BlLm5ld0l0ZW0udGVybSl7XG4gICAgICAgIHNlYXJjaEJ5LnRlcm0gPSAkc2NvcGUubmV3SXRlbS50ZXJtO1xuICAgICAgfVxuICAgICAgY29uc29sZS5sb2coXCJzZWFyY2hCeTpcIiwgc2VhcmNoQnkpO1xuXG4gICAgICBCdXNpbmVzcy5zZWFyY2hDYXRhZ29yaWVzKHNlYXJjaEJ5KVxuICAgICAgLnRoZW4ocmVzID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcInJlcyBmcm9tIHNlYXJjaCBidXNpbnNlc3M6XCIgLCByZXMpO1xuICAgICAgICBmb3IodmFyIGk9MDsgaTwgZmF2b3JpdGVzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuaWQgLFwiIHZzIFwiLCBmYXZvcml0ZXNbaV0pO1xuICAgICAgICAgIGlmKHJlcy5pZCA9PT0gZmF2b3JpdGVzW2ldKXtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGVGYXZlID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLmJ1c2luZXNzZXMucHVzaChyZXMpO1xuICAgICAgfSkgICAgXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVyciBpbiBidXNpbmVzc0N0cmw6IFwiLCBlcnIpO1xuICAgICAgfSlcbiAgICB9XG5cblxuICAgIC8vYWRkIHRvIHVzZXIgZmF2b3JpdGVzXG4gICAgJHNjb3BlLmZhdm9yaXRlID0gKGluZGV4KT0+e1xuICAgICAgJHNjb3BlLnRvZ2dsZUZhdmUgPSAhJHNjb3BlLnRvZ2dsZUZhdmU7XG4gICAgICBjb25zb2xlLmxvZyhcIiRzY29wZS5idXNpbmVzc2VzW2luZGV4XS5pZFwiLCAkc2NvcGUuYnVzaW5lc3Nlc1tpbmRleF0uaWQpXG4gICAgICBVc2VyLmFkZEZhdm9yaXRlVG9Vc2VyKCBQcm9maWxlLl9pZCwgJHNjb3BlLmJ1c2luZXNzZXNbaW5kZXhdLmlkKVxuICAgICAgLnRoZW4oQnVzaW5lc3MuYWRkRmF2b3JpdGUoJHNjb3BlLmJ1c2luZXNzZXNbaW5kZXhdLCBQcm9maWxlLl9pZCkpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzOlwiICwgcmVzKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVyciBpbiBidXNpbmVzc0N0cmw6IFwiLCBlcnIpO1xuICAgICAgfSkgICAgXG4gICAgICBjb25zb2xlLmxvZyhcIiRzY29wZS5idXNpbmVzc2VzW2luZGV4XTpcIiwgJHNjb3BlLmJ1c2luZXNzZXNbaW5kZXhdLmlkKTtcbiAgICAgIC8qICAgICBcbiAgICAgIC50aGVuKHJlcyA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXM6XCIgLCByZXMpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyIGluIGJ1c2luZXNzQ3RybDogXCIsIGVycik7XG4gICAgICB9KSovXG4gICAgfVxuXG4gICAgJHNjb3BlLnVuRmF2b3JpdGUgPSAoaW5kZXgpPT57XG4gICAgICAkc2NvcGUudG9nZ2xlRmF2ZSA9ICEkc2NvcGUudG9nZ2xlRmF2ZTtcbiAgICAgIGNvbnNvbGUubG9nKFwiJHNjb3BlLmJ1c2luZXNzZXNbaW5kZXhdLmlkXCIsICRzY29wZS5idXNpbmVzc2VzW2luZGV4XS5pZClcbiAgICAgIFVzZXIucmVtb3ZlRmF2b3JpdGVmcm9tVXNlciggUHJvZmlsZS5faWQsICRzY29wZS5idXNpbmVzc2VzW2luZGV4XS5pZClcbiAgICAgIC8vLnRoZW4oQnVzaW5lc3MucmVtb3ZlRmF2b3JpdGUoJHNjb3BlLmJ1c2luZXNzZXNbaW5kZXhdLCBQcm9maWxlLl9pZCkpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzOlwiICwgcmVzKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVyciBpbiBidXNpbmVzc0N0cmw6IFwiLCBlcnIpO1xuICAgICAgfSkgICAgXG4gICAgICBjb25zb2xlLmxvZyhcIiRzY29wZS5idXNpbmVzc2VzW2luZGV4XTpcIiwgJHNjb3BlLmJ1c2luZXNzZXNbaW5kZXhdLmlkKTtcbiAgICB9XG5cbn0pOyIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcignaW1hZ2VDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBVcGxvYWQsIFByb2ZpbGUsICRyb290U2NvcGUpIHtcbiAgY29uc29sZS5sb2coXCJpbWFnZSBjdHJsXCIpO1xuXG5cbiAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IFByb2ZpbGU7XG5cbiAgJHNjb3BlLnN1Ym1pdCA9ICgpID0+e1xuICAgIGNvbnNvbGUubG9nKCdzdWJtaXQnKTtcbiAgICBjb25zb2xlLmxvZygnJHNjb3BlLmZpbGU6JywgJHNjb3BlLmZpbGUpO1xuICAgIFxuICAgIFVwbG9hZC51cGxvYWQoe1xuICAgICAgdXJsOiAnL2FwaS9pbWFnZXMnLFxuICAgICAgZGF0YToge3Bob3RvOiAkc2NvcGUuZmlsZSwgdXNlcjogJHJvb3RTY29wZS5jdXJyZW50VXNlci5faWR9IC8vYW55dGhpbmcgZWxzZSBsaWtlIG5hbWUgd2lsbCBlbmQgdXAgaW4gcmVxLmJvZHlcbiAgICB9KVxuICAgIC50aGVuKHJlcyA9PntcbiAgICAgIGNvbnNvbGUubG9nKCdyZXM6ICcsIHJlcyk7XG4gICAgICAkc2NvcGUuc2F2ZWRJbWFnZSA9IHJlcy5kYXRhO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpXG4gICAgfSlcbiAgfTtcblxufSk7XG5cbiAgLyokc2NvcGUuY3J1ZHMgPSBbXTtcblxuICBDcnVkLmdldEFsbCgpXG4gIC50aGVuKHJlcyA9PntcbiAgICAkc2NvcGUuY3J1ZHMgPSByZXMuZGF0YTtcbiAgICBjb25zb2xlLmxvZyhcIiRzY29wZS5jcnVkczpcIiwgJHNjb3BlLmNydWRzKTtcbiAgfSlcbiAgLmNhdGNoKGVyciA9PntcbiAgICBjb25zb2xlLmxvZyhcImVycjogXCIsIGVycik7XG4gIH0pXG5cbiAgJHNjb3BlLmFkZENydWQgPSAoKSA9PntcbiAgICBDcnVkLmFkZENydWQoJHNjb3BlLm5ld0l0ZW0pXG4gICAgLnRoZW4oY3J1ZCA9PntcbiAgICAgICRzY29wZS5jcnVkcy5wdXNoKGNydWQpO1xuICAgICAgJHNjb3BlLm5ld0l0ZW0gPSB7fTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnI9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3I6IFwiLCBlcnIgKTtcbiAgICB9KTtcbiAgfVxuXG5cbiAgJHNjb3BlLmRlbGV0ZUNydWQgPSAoaW5kLCBjcnVkKSA9PntcbiAgICBjb25zb2xlLmxvZyhcImNydWQ6XCIsIGNydWQpXG4gICAgQ3J1ZC5kZWxldGVDcnVkKGNydWQuX2lkKVxuICAgIC50aGVuKGNydWQgPT4ge1xuICAgICAgJHNjb3BlLmNydWRzLnNwbGljZShpbmQsMSk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyPT57XG4gICAgICBjb25zb2xlLmxvZyhcImVycm9yOiBcIiwgZXJyICk7XG4gICAgfSk7XG4gIH1cblxuICAkc2NvcGUuc2hvd1VwZGF0ZUZvcm0gPSAoaW5kZXgsIGNydWQpID0+e1xuICAgIGNvbnNvbGUubG9nKFwiaW5kZXg6IFwiLCBpbmRleCk7XG4gICAgY29uc29sZS5sb2coXCJjcnVkOiBcIiwgY3J1ZCk7XG4gICAgJHNjb3BlLnNob3dVcGRhdGUgPXRydWU7XG4gICAgJHNjb3BlLnVwZGF0ZUl0ZW0gPSBjcnVkO1xuICAgICRzY29wZS51cGRhdGVJbmRleCA9IGluZGV4O1xuICB9XG5cbiAgJHNjb3BlLnVwZGF0ZUNydWQ9ICgpID0+e1xuICAgICRzY29wZS5zaG93VXBkYXRlID1mYWxzZTtcbiAgICBDcnVkLnVwZGF0ZUNydWQoJHNjb3BlLnVwZGF0ZUl0ZW0uX2lkLCAkc2NvcGUudXBkYXRlSXRlbSlcbiAgICAudGhlbihjcnVkID0+e1xuICAgICAgY29uc29sZS5sb2coXCJ1cGRhdGUgYXB0OlwiICwgJHNjb3BlLnVwZGF0ZUl0ZW0uX2lkLCBcIiAsIFwiICwgJHNjb3BlLnVwZGF0ZUl0ZW0pO1xuICAgIH0pXG4gICAgLmNhdGNoKGVycj0+e1xuICAgICAgY29uc29sZS5sb2coXCJlcnJvcjogXCIsIGVyciApO1xuICAgIH0pO1xuICB9XG4qL1xuXG4iLCJcbid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcignbG9naW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsICRhdXRoLCAkcm9vdFNjb3BlKSB7XG4gIGNvbnNvbGUubG9nKCdsb2dpbkN0cmwhJyk7XG5cbiAgJHNjb3BlLmxvZ2luID0gKCkgPT4ge1xuICAgICAgJGF1dGgubG9naW4oJHNjb3BlLnVzZXIpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzOiBcIiwgcmVzKTtcbiAgICAgICAgLy8kcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gcmVzLmRhdGE7XG4gICAgICAgICRzdGF0ZS5nbygncHJvZmlsZScpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgICAgfSlcbiAgICB9O1xufSk7IiwiJ3VzZSBzdHJpY3QnO1xuXG5sZXQgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5jb250cm9sbGVyKCdtYWluQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCAkYXV0aCwgJHJvb3RTY29wZSkge1xuICBjb25zb2xlLmxvZygnbWFpbkN0cmwhJyk7XG5cbiAgJHJvb3RTY29wZS5jdXJyZW50VXNlcjtcblxuICAkc2NvcGUuaXNBdXRoZW50aWNhdGVkID0gKCkgPT4gJGF1dGguaXNBdXRoZW50aWNhdGVkKCk7XG5cbiAgJHNjb3BlLmxvZ291dCA9ICgpID0+IHtcbiAgICAkYXV0aC5sb2dvdXQoKTtcbiAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgfTtcblxuICAkc2NvcGUuYXV0aGVudGljYXRlID0gcHJvdmlkZXIgPT4ge1xuICAgICRhdXRoLmF1dGhlbnRpY2F0ZShwcm92aWRlcilcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgICB9KVxuICB9O1xufSk7XG4iLCIndXNlIHN0cmljdCc7XG5cbmxldCBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnKTtcblxuYXBwLmNvbnRyb2xsZXIoJ3Byb2ZpbGVDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBQcm9maWxlLCBQcm9maWxlQnlJRCwgJHN0YXRlLCBVc2VyLCAkcm9vdFNjb3BlLCBXYWxsUG9zdCkge1xuICBcbiAgY29uc29sZS5sb2coJ3Byb2ZpbGVDdHJsIScpO1xuXG4gICRyb290U2NvcGUuY3VycmVudFVzZXIgPSBQcm9maWxlO1xuXG4gICRzY29wZS51c2VyID0gUHJvZmlsZUJ5SUQgfHwgUHJvZmlsZTtcblxuICBXYWxsUG9zdC5nZXRXYWxsUG9zdHMoJHNjb3BlLnVzZXIuX2lkKVxuICAgIC50aGVuKHJlcyA9PntcbiAgICAkc2NvcGUudXNlcldhbGxwb3N0cyA9IHJlcztcbiAgfSlcblxuICBjb25zb2xlLmxvZyhcInVzZXI6XCIsICRzY29wZS51c2VyICk7XG4gIGNvbnNvbGUubG9nKFwiY3VycnVzZXI6XCIsICRyb290U2NvcGUuY3VycmVudFVzZXIgKTtcblxuICAkc2NvcGUuc2hvd2Rpc3BsYXlOYW1lRm9ybSA9ICgpID0+e1xuICAgIGNvbnNvbGUubG9nKFwic2hvdyBmb3JtXCIpO1xuICAgICRzY29wZS5kaXNwbGF5TmFtZUZvcm0gPSB0cnVlO1xuICB9XG5cbiAgJHNjb3BlLnVwZGF0ZWRpc3BsYXlOYW1lID0gKCkgPT4ge1xuICAgICRzY29wZS5kaXNwbGF5TmFtZUZvcm0gPSBmYWxzZTtcbiAgICAkc2NvcGUudXNlci5kaXNwbGF5TmFtZSA9ICRzY29wZS5uZXdJdGVtLmRpc3BsYXlOYW1lO1xuICAgIFVzZXIudXBkYXRlUHJvZmlsZSgkc2NvcGUudXNlci5faWQsICRzY29wZS5uZXdJdGVtKVxuICAgICAgLnRoZW4ocHJvZmlsZSA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJwcm9maWxlOlwiLCBwcm9maWxlKTtcbiAgICAgICAgJHNjb3BlLm5ld0l0ZW0uZGlzcGxheU5hbWUgPSAnJztcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICAgIH0pXG4gIH1cblxuICAkc2NvcGUuY2FuY2VsZGlzcGxheU5hbWUgPSAoKSA9PntcbiAgICAkc2NvcGUudXNlcm5hbWVGb3JtID0gdHJ1ZTtcbiAgICAkc2NvcGUubmV3SXRlbS5kaXNwbGF5TmFtZSA9ICcnO1xuICB9XG5cbi8vcGhvdG9cbiAgJHNjb3BlLnNob3dQaWN0dXJlRm9ybSA9ICgpID0+e1xuICAgIGNvbnNvbGUubG9nKFwic2hvdyBmb3JtXCIpO1xuICAgICRzY29wZS5waG90b0Zvcm0gPSB0cnVlO1xuICB9XG5cbiAgJHNjb3BlLnVwZGF0ZVBpY3R1cmUgPSAoKSA9PiB7XG4gICAgJHNjb3BlLnBob3RvRm9ybSA9IGZhbHNlO1xuICAgIGNvbnNvbGUubG9nKFwiJHN0YXRlLmN1cnJlbnQ6IFwiLCAkc3RhdGUuY3VycmVudCk7XG4gICAgJHNjb3BlLnVzZXIucHJvZmlsZUltYWdlID0gJHNjb3BlLm5ld0l0ZW0ucHJvZmlsZUltYWdlO1xuICAgIGNvbnNvbGUubG9nKFwiJHNjb3BlLm5ld0l0ZW06XCIsICRzY29wZS5uZXdJdGVtKTtcbiAgICBVc2VyLnVwZGF0ZVByb2ZpbGUoJHNjb3BlLnVzZXIuX2lkLCAkc2NvcGUubmV3SXRlbSlcbiAgICAgIC50aGVuKHByb2ZpbGUgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicHJvZmlsZTpcIiwgcHJvZmlsZSk7XG4gICAgICAgICRzY29wZS5uZXdJdGVtLnByb2ZpbGVJbWFnZSA9ICcnO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgICAgfSlcbiAgfVxuXG4gICRzY29wZS5jYW5jZWxQaG90b1VybCA9ICgpID0+e1xuICAgICRzY29wZS5waG90b0Zvcm0gPSB0cnVlO1xuICAgICRzY29wZS5uZXdJdGVtLnBob3RvVXJsID0gJyc7XG4gIH1cblxuXG4gICRzY29wZS5kZWxldGVBY2NvdW50ID0gKHVzZXIpID0+e1xuICAgIC8vYWRkIHN3YWxcbiAgICBjb25zb2xlLmxvZyh1c2VyLl9pZCk7XG4gICAgVXNlci5kZWxldGVBY2NvdW50KHVzZXIuX2lkKVxuICAgICAgLnRoZW4oKVxuICAgICAgLmNhdGNoKGVyciA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnI6IFwiLCBlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICAgICRzY29wZS5zdWJtaXRNZXNzYWdlID0gKCkgPT57XG5cbiAgICB2YXIgcG9zdE9iaiA9IHtcbiAgICAgIHRvOiAkc2NvcGUudXNlcixcbiAgICAgIGZyb206ICRyb290U2NvcGUuY3VycmVudFVzZXIuX2lkLFxuICAgICAgZnJvbU5hbWU6ICRyb290U2NvcGUuY3VycmVudFVzZXIuZGlzcGxheU5hbWUsXG4gICAgICB0ZXh0OiAkc2NvcGUubmV3SXRlbS50ZXh0LFxuICAgICAgY3JlYXRlZEF0OiBcImFkZCBtb21lbnRcIlxuICAgIH07XG5cbiAgICBjb25zb2xlLmxvZyhcInBvc3Qgb2JqOlwiLCBwb3N0T2JqKTtcblxuXG4gICAgV2FsbFBvc3QuYWRkV2FsbFBvc3QocG9zdE9iailcbiAgICAgIC50aGVuKHdhbGxwb3N0ID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcIndhbGxwb3N0OlwiICwgd2FsbHBvc3QpO1xuICAgICAgICBVc2VyLmFkZFdhbGxQb3N0VG9Vc2VyKFByb2ZpbGVCeUlELl9pZCwgd2FsbHBvc3QuX2lkKTtcbiAgICAgIH0pXG4gICAgICAudGhlbigkc3RhdGUuZ28oJHN0YXRlLiRjdXJyZW50LCBudWxsLCB7IHJlbG9hZDogdHJ1ZSB9KSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOiBcIiwgZXJyKTtcbiAgICAgIH0pXG4gICB9O1xuXG5cbn0pOyIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcigncmVnaXN0ZXJDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsICRhdXRoKSB7XG4gIGNvbnNvbGUubG9nKCdyZWdpc3RlckN0cmwhJyk7XG5cbiAgJHNjb3BlLnJlZ2lzdGVyID0gKCkgPT4ge1xuICAgIGlmKCRzY29wZS51c2VyLnBhc3N3b3JkICE9PSAkc2NvcGUudXNlci5wYXNzd29yZDIpe1xuICAgICAgJHNjb3BlLnVzZXIucGFzc3dvcmQgPSBudWxsO1xuICAgICAgJHNjb3BlLnVzZXIucGFzc3dvcmQyID0gbnVsbDtcbiAgICAgIGFsZXJ0KCdQYXNzd29yZHMgbXVzdCBtYXRjaCEnKTtcbiAgICB9ZWxzZXtcbiAgICAgICRhdXRoLnNpZ251cCgkc2NvcGUudXNlcilcbiAgICAgIC50aGVuKHJlcyA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXM6IFwiLCByZXMpO1xuICAgICAgICAkc3RhdGUuZ28oJ2xvZ2luJyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgICB9KVxuICAgIH1cbiAgfTtcbn0pOyIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcignc2hvd2J1c2luZXNzQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlUGFyYW1zLCBCdXNpbmVzcykge1xuICBjb25zb2xlLmxvZygnc2hvd2J1c2luZXNzQ3RybCEnKTtcblxuICBsZXQgYnVzaW5lc3NJZCA9ICRzdGF0ZVBhcmFtcztcbiAgY29uc29sZS5sb2coXCJidXNpbmVzc0lkXCIsIGJ1c2luZXNzSWQuYnVzaW5lc3NJZCk7XG5cbiAgQnVzaW5lc3Muc2VhcmNoWWVscChidXNpbmVzc0lkLmJ1c2luZXNzSWQpXG4gIC50aGVuKHJlcyA9PntcbiAgICBjb25zb2xlLmxvZyhcInJlczpcIiAsIHJlcyk7XG4gICAgJHNjb3BlLmJ1c2luZXNzID0gcmVzO1xuICB9KSAgICBcbiAgLmNhdGNoKGVyciA9PntcbiAgICBjb25zb2xlLmxvZyhcImVyciBpbiBidXNpbmVzc0N0cmw6IFwiLCBlcnIpO1xuICB9KVxuXG59KTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcigndXNlcnNDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkJHN0YXRlLCAkc3RhdGUsIFVzZXIpIHtcbiAgY29uc29sZS5sb2coJ3VzZXJzQ3RybCEnKTtcblxuICB2YXIgdXNlclByb21pc2UgPSBVc2VyLmdldEFsbCgpO1xuICBjb25zb2xlLmxvZyhcInVzZXJQcm9taXNlOlwiLCB1c2VyUHJvbWlzZSk7XG4gIHVzZXJQcm9taXNlLnRoZW4oXG4gICAgZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgY29uc29sZS5sb2cocmVzdWx0LmRhdGEpO1xuICAgICAgICRzY29wZS51c2VyRmVlZCA9IHJlc3VsdC5kYXRhO1xuICAgIH0pO1xufSk7IiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5zZXJ2aWNlKCdCdXNpbmVzcycsIGZ1bmN0aW9uKCRodHRwLCAkcSl7XG5cbiAgdGhpcy5zZWFyY2hZZWxwID0gKHNlYXJjaCkgPT57XG4gICAgY29uc29sZS5sb2coXCJzZWFyY2g6IFwiLCBzZWFyY2gpO1xuICAgIHJldHVybiAkaHR0cC5nZXQoYC9hcGkvYnVzaW5lc3Nlcy95ZWxwLyR7c2VhcmNofWApXG4gICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzLmRhdGEgaW4gc2VydmljZXM6XCIsIHJlcy5kYXRhKTtcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXMgaW4gc2VydmljZXM6XCIsIHJlcyk7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKHJlcy5kYXRhKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHsgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgICAgfSlcbiAgfVxuXG4gIHRoaXMuc2VhcmNoQ2F0YWdvcmllcyA9IChpbnB1dHMpID0+e1xuICAgIGNvbnNvbGUubG9nKFwiaW5wdXRzXCIsIGlucHV0cyk7XG4gICAgcmV0dXJuICRodHRwLmdldChgL2FwaS9idXNpbmVzc2VzL3llbHBDYXRhZ29yaWVzYCwgaW5wdXRzKVxuICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhcInJlcy5kYXRhIGluIHNlcnZpY2VzOlwiLCByZXMuZGF0YSk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzIGluIHNlcnZpY2VzOlwiLCByZXMpO1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7ICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyKTtcbiAgICAgIH0pXG4gIH1cblxuICB0aGlzLmFkZEZhdm9yaXRlID0gKGJ1c2luZXNzT2JqLCB1c2VySWQpID0+e1xuICAgIGNvbnNvbGUubG9nKFwiYnVzaW5lc3NPYmo6XCIsIGJ1c2luZXNzT2JqKTtcbiAgICByZXR1cm4gJGh0dHAucG9zdChgL2FwaS9idXNpbmVzc2VzLyR7dXNlcklkfWAsIGJ1c2luZXNzT2JqKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzIGxuIDI0IGJ1c2luZXNzIHNlcnZpY2VzOlwiLCByZXMpO1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4geyAgIFxuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgICB9KVxuICAgIH07XG59KTtcblxuLy9kbyBmaW5kLCBpZiBub3QgaW4gZGIgdGhlbiBhZGQsIGlmIGluIGRiIGFkZCB1c2VyIHRvIGZhdm9yaXRlZCIsIid1c2Ugc3RyaWN0JztcblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuc2VydmljZSgnaW1hZ2UnLCBmdW5jdGlvbigkaHR0cCwgJHEpe1xuXG4gIHRoaXMuZ2V0QWxsID0gKCkgPT57XG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jcnVkcycpO1xuICB9XG5cbiAgdGhpcy5nZXRCeUlkID0gaWQgPT57XG4gICAgcmV0dXJuICRodHRwLmdldChgL2FwaS9jcnVkcy8ke2lkfWApO1xuICB9XG5cbiAgdGhpcy5hZGRDcnVkPSAoY3J1ZCkgPT57XG4gICAgcmV0dXJuICRodHRwLnBvc3QoYC9hcGkvY3J1ZHNgLCBjcnVkKVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUocmVzLmRhdGEpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4geyAgIFxuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgICB9KVxuICAgIH07XG5cbiAgdGhpcy5kZWxldGVDcnVkID0gKGlkKSA9PntcbiAgICByZXR1cm4gJGh0dHAuZGVsZXRlKGAvYXBpL2NydWRzLyR7aWR9YClcbiAgICAgIC50aGVuKCAoKSA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7ICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyKTtcbiAgICAgIH0pXG4gICAgfTtcblxuICB0aGlzLnVwZGF0ZUNydWQgPSAoaWQsIGNydWQpID0+e1xuICAgICAgcmV0dXJuICRodHRwLnB1dChgL2FwaS9jcnVkcy8ke2lkfWAsIGNydWQpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShjcnVkKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHsgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgICAgfSlcbiAgICB9O1xuXG59KTtcblxuLy9pbiByZXNpZGVudHMgUmVzaWRlbnQuZ2V0QWxsKClcbi8vICAgICAgICAgICAgICAgIC50aGVuKHJlc2lkZW50cyA9Pnt9KSIsIid1c2Ugc3RyaWN0JztcblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuc2VydmljZSgnVXNlcicsIGZ1bmN0aW9uKCRodHRwLCAkcSkge1xuXG4gIHRoaXMucHJvZmlsZSA9ICgpID0+IHtcbiAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzL3Byb2ZpbGUnKVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUocmVzLmRhdGEpO1xuICAgICAgfSk7XG4gIH07XG5cbiAgdGhpcy5nZXRQcm9maWxlID0gKGlkKSA9PntcbiAgICAgcmV0dXJuICRodHRwLmdldChgL2FwaS91c2Vycy9wcm9maWxlLyR7aWR9YClcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgfSk7XG4gIH1cblxuICB0aGlzLmdldEFsbCA9ICgpID0+e1xuICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMnKTtcbiAgfVxuXG4gIHRoaXMudXBkYXRlUHJvZmlsZSA9IChpZCwgcHJvZmlsZU9iaikgPT57XG4gICAgY29uc29sZS5sb2coXCJoZXJlXCIpO1xuICAgIGNvbnNvbGUubG9nKGlkICwgXCIgXCIgLHByb2ZpbGVPYmopO1xuICAgIHJldHVybiAkaHR0cC5wdXQoYC9hcGkvdXNlcnMvcHJvZmlsZS8ke2lkfWAsICBwcm9maWxlT2JqKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgfSk7XG4gIH1cblxuICB0aGlzLmRlbGV0ZUFjY291bnQgPSAoaWQpID0+e1xuICAgIHJldHVybiAkaHR0cC5kZWxldGUoYC9hcGkvdXNlcnMvcHJvZmlsZS8ke2lkfWApXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUoKTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnIgPT57XG4gICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICB9KTtcbiAgfVxuXG4gIHRoaXMuYWRkRmF2b3JpdGVUb1VzZXIgPSAoaWQsIHllbHBJZCkgPT57XG4gICAgLy9jb25zb2xlLmxvZyhcImFkZEZhdm9yaXRlVG9Vc2VyXCIsIFwiaWQ6XCIsIGlkLCBcInllbHBJZFwiLCB5ZWxwSWQpXG4gICAgcmV0dXJuICRodHRwLnB1dChgL2FwaS91c2Vycy9wcm9maWxlLyR7aWR9L2FkZC8ke3llbHBJZH1gKVxuICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwicmVzIGxuIDUzOlwiLCByZXMpO1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgIH0pO1xuICB9XG5cbiAgdGhpcy5yZW1vdmVGYXZvcml0ZWZyb21Vc2VyID0gKGlkLCB5ZWxwSWQpID0+e1xuICAgIGNvbnNvbGUubG9nKFwicmVtb3ZlIEZhdm9yaXRlXCIsIFwiaWQ6XCIsIGlkLCBcInllbHBJZFwiLCB5ZWxwSWQpXG4gICAgcmV0dXJuICRodHRwLnB1dChgL2FwaS91c2Vycy9wcm9maWxlLyR7aWR9L3JlbW92ZS8ke3llbHBJZH1gKVxuICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhcInJlcyBsbiA1MzpcIiwgcmVzKTtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUoKTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnIgPT57XG4gICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICB9KTtcbiAgfVxuIFxuXG59KTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuc2VydmljZSgnV2FsbFBvc3QnLCBmdW5jdGlvbigkaHR0cCwgJHEpIHtcblxuICAgIHRoaXMuYWRkV2FsbFBvc3Q9ICh3YWxscG9zdCkgPT57XG4gICAgY29uc29sZS5sb2coXCJpbiBhZGQgd2FsbHBvc3Q6IFwiLCB3YWxscG9zdCk7XG4gICAgcmV0dXJuICRodHRwLnBvc3QoYC9hcGkvd2FsbHBvc3RzYCwgd2FsbHBvc3QpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7ICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyKTtcbiAgICAgIH0pXG4gICAgfTtcblxuXG4gICAgdGhpcy5nZXRXYWxsUG9zdHMgPSAodXNlcklkKSA9PntcbiAgICByZXR1cm4gJGh0dHAuZ2V0KGAvYXBpL3dhbGxwb3N0cy8ke3VzZXJJZH1gKVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUocmVzLmRhdGEpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnI9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnI6IFwiLCBlcnIpO1xuICAgICAgfSk7XG4gIH07XG5cbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
